@page "/counter"
@using System.Drawing
@using System.Timers
@rendermode InteractiveServer
@inject HttpClient client

<PageTitle>Counter</PageTitle>

<h1>Color</h1>

<div style="width: 300px; height: 300px; background-color:rgb(@Color.R, @Color.G, @Color.B)">
    
</div>

<button class="btn btn-primary" @onclick="(async () => await CheckColor())">Click me</button>

@code {
    public Color Color { get; set; } = Color.Aquamarine;

    class ColorSensorData
    {
        public int Red { get; set; }
        public int Green { get; set; }
        public int Blue { get; set; }
        public int Clear { get; set; }
        public int ColorTemp { get; set; }
        public int Lux { get; set; }
    }

    private async Task CheckColor()
    {
        var result = await client.GetFromJsonAsync<ColorSensorData>("Sync/ReadColorSensor") ?? new ColorSensorData();
        Color = Color.FromArgb(1, 
            (byte)((0xFF) * (result.Red / (float)(0xFFFF))), 
            (byte)((0xFF) * (result.Green / (float)(0xFFFF))),
            (byte)((0xFF) * (result.Blue / (float)(0xFFFF))));
    }
}